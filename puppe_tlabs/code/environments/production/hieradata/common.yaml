#
# This file is laid out similarly as the client request would go
#
# These entires need to be here unless we set the boxes to use local DNS
#

# user accounts
accounts::user_defaults:
  purge_ssh_keys: true
accounts::users:
  tcrowder:
    groups: ['users', 'wheel']
    ssh_keys:
      'tcrowder@Traviss-MacBook-Pro.local':
        type: 'ssh-rsa'
        key: 'AAAAB3NzaC1yc2EAAAADAQABAAABAQDo68BjFBtxlDFwnGuU8mXWYZZ901peAcsPwn5cAT/0Gio8xRnFaaz63tsoP4y6HLCtAJwjhgKEtyj9khM7bbRm+KMD5Z9bpM21AYlKWY1cbfKKZZH8oXKLQaHrZNFhbbRCnGL+jLpN0wB1QnkzINEEAdtrPdnqjb1oHv8YUql2em6Iw390qrd4GFjvnAIlf0nawdrQIImMPRDOWKqW4g1tOQNxTprd1hzn8DfErA1Q0tsubSQbmT0p2S785wOsDCLggUTHScZYPf7L9wMCMAoFAiAt/1XwlQoAGS1dKOruO2mMPY3Y/ROnWifvPJqoRl+g3h6h796I+8qXu5nf0GMZ'
  rroper:
    groups: ['users', 'wheel']
    ssh_keys:
      'ryan@ryanroper.com':
        type: 'ssh-rsa'
        key: 'AAAAB3NzaC1yc2EAAAADAQABAAABAQDhVNCfamboX9Arzqj4Cg+l1ktH2nwqa15A/seRZimKhThfOJasSbniDuk3REkL0kPcgnei7u/5fseYXxx5+3yRg+2h1Okmi3z1llnXSnPFztVFE31cxWzU5FPtFc/wSJwL1O4JN+8VSg79ex9PY+TNV2ksOY8uNpyu7HULHHwkwrSdYr3bipVHlmFo9VtkSsduiXRtbrO6WVlfJ8jSMsqpp+LYO08BkjCphn/ddrXnWBD0cwBr7Byo1Lc6MDZw1vxIK5kW5u3SQtTFJknNDdGpuX5AghWhPn3BWwj1kRIJfjn2yBEY8T7seEgUf6F01LP9V16aGp1UuG5N4ESBT0eF'

# hosts file
hosts::host_entries:
  'nfscache.beyond79.com':
    ip: '172.31.7.193'
  'puppet':
      ip: '52.89.210.175'
  'secure.apigx.com':
      ip: '172.31.11.0'
  'admin.apigx.com':
      ip: '172.31.3.44'
  'apigx.com':
      ip: '172.31.11.0'
# Incoming request on 443 (SSL) -- Hits ELB (443:80) -> Varnish Cache (80:8081) -> Nginx (Cname Resolution) (8081:80) -> ELB (80:80) -> Web Heads (80)
# Incoming request on 80 (Non-SSL - Redirect to SSL) -- Hits ELB (80:8080) -> Nginx (Redirect to 443) ^
## Varnish Section

## Nginx Section (Redirector and Backend CNAME resolution box - needs two ports)
## Varnish Section (needs a port)
## Nginx Section (port 80 Backend Web Head)
#nginx::config::sendfile: 'off'
nginx::nginx_upstreams:
  'php_fpm':
    ensure: present
    members:
      - 'unix:/var/run/php-fpm/php-fpm.sock'
## PHP-FPM Section
php::ensure: latest
php::manage_repos: true
php::fpm: true
php::composer: true
php::composer::auto_update: true
php::pear: true
php::phpunit: true
php::fpm::config::log_level: notice
php::fpm::config::user: nginx
php::fpm::config::group: nginx
php::fpm::pools:
  www:
    listen: '/var/run/php-fpm/php-fpm.sock'
    listen_owner: nginx
    listen_group: nginx
    env_value:
      APPLICATION_ENV: 'production'
      ES_CONNECTION_URI: 'http://admin:changeit@172.31.8.50:2113'
      GX_BASE_URL: 'http://secure.apigx.com'
      EDB_DB_NAME: 'd7_edb'
      EDB_DB_USER: 'd7'
      EDB_DB_PASSWORD: 'drup@l7even!'
      EDB_DB_HOST: 'production-lead-sites.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      EDB_DB_DRIVER: 'mysql'
      EDB_MEMCACHED_HOST: 'nfscache.beyond79.com:11211'
      GK_DB_NAME: 'd7_gk'
      GK_DB_USER: 'd7'
      GK_DB_PASSWORD: 'drup@l7even!'
      GK_DB_HOST: 'production-lead-sites.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      GK_DB_DRIVER: 'mysql'
      GK_MEMCACHED_HOST: 'nfscache.beyond79.com:11211'
      OOYL_DB_NAME: 'd7_ooyl'
      OOYL_DB_USER: 'd7'
      OOYL_DB_PASSWORD: 'drup@l7even!'
      OOYL_DB_HOST: 'production-lead-sites.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      OOYL_DB_DRIVER: 'mysql'
      OOYL_MEMCACHED_HOST: 'nfscache.beyond79.com:11211'
      RP_DB_NAME: 'd7_rp'
      RP_DB_USER: 'd7'
      RP_DB_PASSWORD: 'drup@l7even!'
      RP_DB_HOST: 'production-lead-sites.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      RP_DB_DRIVER: 'mysql'
      RP_MEMCACHED_HOST: 'nfscache.beyond79.com:11211'
      SYG_DB_NAME: 'd7_syg'
      SYG_DB_USER: 'd7'
      SYG_DB_PASSWORD: 'drup@l7even!'
      SYG_DB_HOST: 'production-lead-sites.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      SYG_DB_DRIVER: 'mysql'
      SYG_MEMCACHED_HOST: 'nfscache.beyond79.com:11211'
      TWB_DB_NAME: 'd7_twb'
      TWB_DB_USER: 'd7'
      TWB_DB_PASSWORD: 'drup@l7even!'
      TWB_DB_HOST: 'production-lead-sites.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      TWB_DB_DRIVER: 'mysql'
      TWB_MEMCACHED_HOST: 'nfscache.beyond79.com:11211'
      B79_DB_NAME: 'd7_beyond79'
      B79_DB_USER: 'd7'
      B79_DB_PASSWORD: 'drup@l7even!'
      B79_DB_HOST: 'production-lead-sites.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      B79_DB_DRIVER: 'mysql'
      B79_MEMCACHED_HOST: 'nfscache.beyond79.com:11211'
      DB_USER: 'goldexchange'
      DB_USERNAME: 'goldexchange'
      DB_PASSWORD: 'g0ld13l0cks'
      DB_HOST: 'production-goldexchange.cs4ybiuq7yk8.us-west-2.rds.amazonaws.com'
      DB_NAME: 'goldexchange'
      DB_DATABASE: 'goldexchange'
      MEMCACHED_HOST: 'nfscache.beyond79.com'
      MEMCACHED_PORT: '11211'
      wmc_api_url: 'https://api.webmasterchecks.com/'
      wmc_api_client_id: '205'
      wmc_api_akey: 'tiUVJ+XW8Hgp29phhY8AKHLvT/N+EkvAlPIFNm0er8QecNDM8hXahKodEyKeJeuMr4fK5Y9HCWXLHmkdsU0a5M9vhw6jxSWmR7fiWxdg5rM4GovkRi218h98v6vURKan'
      paypal_api_url: 'https://svcs.paypal.com/AdaptivePayments/'
      paypal_app_id: 'APP-8RW10306NM684840R'
      paypal_api_username: 'paypal_api1.beyond79.com'
      paypal_api_password: '94KUVT84WVC5D7GN'
      paypal_api_key: 'AN3yjmAmdrHdk6GwO8PRVH9WPE-9A.O6q6C7eXJqKqjSWFWoiU2NlPDv'
      paypal_api_email: 'paypal@beyond79.com'
      paypal_sender_email: 'paypal@beyond79.com'
php::settings:
  Date\date.timezone: America/New_York
  PHP/variables_order: EGPCS
php::fpm::settings:
  PHP/memory_limit: 128M
  PHP/short_open_tag: 'On'
php::extensions:
  mysqlnd: {}
  mbstring: {}
  mcrypt: {}
  xml: {}
  soap: {}
  opcache: {}
  bcmath: {}
  gd: {}
  intl: {}
## MySQL Section

#NFS Section